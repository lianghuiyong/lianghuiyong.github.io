(window.webpackJsonp=window.webpackJsonp||[]).push([[20,4],{457:function(t,e,o){var content=o(475);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(43).default)("d507045c",content,!1,{sourceMap:!1})},458:function(t,e,o){"use strict";var n=o(122);e.a={upImage:function(t,e,l,r){l.size>2097152?r.error("文件大小不能超过2M"):new(o(476))({getAuthorization:function(e,o){t.$axios.post(n.a.UP_LOAD_TOKEN).then((function(data){o({TmpSecretId:data.credentials.tmpSecretId,TmpSecretKey:data.credentials.tmpSecretKey,SecurityToken:data.credentials.sessionToken,StartTime:data.startTime,ExpiredTime:data.expiredTime,ScopeLimit:!0})})).catch((function(t){r.error("上传失败")}))}}).putObject({Bucket:"huiyong-online-1251911077",Region:"ap-guangzhou",Key:e,Body:l,onProgress:function(t){r.progress(t.percent)}},(function(t,data){t?r.error("上传失败"):r.success("上传成功")}))}}},474:function(t,e,o){"use strict";o(457)},475:function(t,e,o){var n=o(42)(!1);n.push([t.i,".add-blog-dialog-box .add-blog-item[data-v-3063e33a]{font-size:15px;color:#4d4d4d;margin-bottom:20px;display:flex;align-items:center;justify-content:flex-start}.add-blog-dialog-box .add-blog-item .add-blog-item-title[data-v-3063e33a]{width:80px;-moz-text-align-last:justify;text-align-last:justify}.add-blog-dialog-box .add-blog-item .el-input--small[data-v-3063e33a]{width:200px}.add-blog-dialog-box .add-blog-item .add-blog-tag[data-v-3063e33a]{font-size:14px;color:#409eff;margin-left:10px;cursor:pointer}.add-menu-dialog-footer[data-v-3063e33a]{display:flex;align-items:center;justify-content:center}.add-menu-dialog-footer .el-button[data-v-3063e33a]{width:200px}",""]),t.exports=n},493:function(t,e,o){"use strict";o.r(e);o(45);var n=o(122),l=o(83),r={props:["show","blogStatusInfo"],data:function(){return{openStatus:1,priCode:null,selectTag:"",tagList:[]}},watch:{show:function(t,e){t&&(this.openStatus=0|this.blogStatusInfo.openStatus,this.priCode=this.blogStatusInfo.priCode,this.getTagList(this.blogStatusInfo.tagId))}},methods:{close:function(){this.$emit("close")},commit:function(){this.priCode&&4!=this.priCode.length?this.$message.warning("权限码长度不够！"):(l.a.setItem("ADD_BLOG_TAG_ID",this.selectTag),this.$emit("commit",{openStatus:this.openStatus,priCode:this.priCode,tagId:this.selectTag}))},getTagList:function(t){var e=this,o=t;this.$axios.post(n.a.BLOG_TAG_LIST).then((function(t){e.tagList=t,o||(o=l.a.getItem("ADD_BLOG_TAG_ID")),o?e.tagList.map((function(t){t.tagId==o&&(e.selectTag=t.tagId)})):e.tagList&&e.tagList.length>0&&(e.selectTag=e.tagList[0].tagId)})).catch((function(t){e.$message.warning(t.message)}))},addTag:function(){var t=this;this.$prompt("请输入分类名","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var o=e.value;t.$axios.post(n.a.BLOG_TAG_ADD,{tagName:o}).then((function(e){t.$message.success("添加分类：".concat(o," 成功！")),t.getTagList(e.data)})).catch((function(e){t.$message.warning(e.message)}))})).catch((function(){}))}}},d=(o(474),o(35)),component=Object(d.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{attrs:{title:"发布文章",visible:t.show,width:"30%",top:"15%"},on:{close:t.close}},[o("div",{staticClass:"add-blog-dialog-box"},[o("div",{staticClass:"add-blog-item"},[o("div",{staticClass:"add-blog-item-title"},[t._v("文章类型：")]),t._v(" "),o("el-radio-group",{model:{value:t.openStatus,callback:function(e){t.openStatus=e},expression:"openStatus"}},[o("el-radio",{attrs:{label:0}},[t._v("公开")]),t._v(" "),o("el-radio",{attrs:{label:1}},[t._v("私密")])],1)],1),t._v(" "),1==t.openStatus?o("div",{staticClass:"add-blog-item"},[o("div",{staticClass:"add-blog-item-title"},[t._v("权限码：")]),t._v(" "),o("el-input",{attrs:{size:"small",maxlength:"4",placeholder:"请输入权限码（可选）","show-word-limit":""},model:{value:t.priCode,callback:function(e){t.priCode=e},expression:"priCode"}})],1):t._e(),t._v(" "),o("div",{staticClass:"add-blog-item"},[o("div",{staticClass:"add-blog-item-title"},[t._v("文章分类：")]),t._v(" "),o("el-select",{attrs:{size:"small",filterable:"",clearable:"",disabled:t.tagList.length<=0,placeholder:"请选择文章分类"},model:{value:t.selectTag,callback:function(e){t.selectTag=e},expression:"selectTag"}},t._l(t.tagList,(function(t){return o("el-option",{key:t.tagId,attrs:{label:t.tagName,value:t.tagId}})})),1),t._v(" "),o("div",{staticClass:"add-blog-tag",on:{click:t.addTag}},[t._v("添加分类")])],1)]),t._v(" "),o("span",{staticClass:"add-menu-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.commit}},[t._v("确定")])],1)])}),[],!1,null,"3063e33a",null);e.default=component.exports},502:function(t,e,o){var content=o(537);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(43).default)("34caaffa",content,!1,{sourceMap:!1})},536:function(t,e,o){"use strict";o(502)},537:function(t,e,o){var n=o(42)(!1);n.push([t.i,".blog-edit-page .blog-top-box{display:flex;align-items:center;justify-content:space-between;padding:20px 24px}.blog-edit-page .blog-top-box .blog-title{flex:1;height:40px;font-size:24px;font-weight:700;color:#000;border:none;margin:0;background:none}.blog-edit-page .blog-top-box .blog-title::-moz-placeholder{color:#86909c}.blog-edit-page .blog-top-box .blog-title:-ms-input-placeholder{color:#86909c}.blog-edit-page .blog-top-box .blog-title::placeholder{color:#86909c}.blog-edit-page .blog-top-box .blog-top-right{display:flex;align-items:center;justify-content:flex-start}.blog-edit-page .blog-top-box .blog-top-right .blog-save-btn{padding:8px 13px;text-align:center;color:#ff4d4d;border-radius:4px;cursor:pointer;border:1px solid #ff4d4d}.blog-edit-page .blog-top-box .blog-top-right .blog-save-btn:hover{background-color:#f6f6f6;border-color:#fc1944}.blog-edit-page .blog-top-box .blog-top-right .blog-submit{padding:8px 13px;text-align:center;color:#fff;background:#ff4d4d;border-radius:4px;cursor:pointer;margin-left:20px}.blog-edit-page .blog-top-box .blog-top-right .blog-submit:hover{background-color:#fc1944}.blog-edit-page .blog-edit{height:calc(100vh - 80px)}",""]),t.exports=n},562:function(t,e,o){"use strict";o.r(e);o(46);var n=o(122),l=o(493),r=o(83),d=o(458),c={components:{AddBlog:l.default},data:function(){return{externalLink:{markdown_css:function(){return"/codeStyle/markdown/github-markdown.min.css"},hljs_js:function(){return"/codeStyle/highlightjs/highlight.min.js"},hljs_css:function(t){return"/codeStyle/highlightjs/styles/"+t+".min.css"},hljs_lang:function(t){return"/codeStyle/highlightjs/languages/"+t+".min.js"},katex_css:function(){return"/codeStyle/katex/katex.min.css"},katex_js:function(){return"/codeStyle/katex/katex.min.js"}},showAddBlog:!1,showDraftBtn:!1,id:"",title:"",content:"",blogStatusInfo:{blogStatus:"",openStatus:"",priCode:"",tagId:""},toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!1,help:!0,undo:!0,redo:!0,trash:!0,save:!1,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!1,preview:!0},userInfo:{userImage:"",userName:"",userId:""}}},mounted:function(){var t=this;this.$nextTick((function(){var e={placeholder:"请输入内容",onChange:function(t){console.log("content",t.children),console.log("html",t.getHtml())}},o=createEditor({selector:"#editor-container",config:e,content:[],mode:"default"});createToolbar({editor:o,selector:"#toolbar-container",mode:"default"});t.id=t.$route.query.id,t.userInfo=r.a.getItem("USER_INFO"),t.id?t.getDetail():t.showDraftBtn=!0}))},methods:{getDetail:function(){var t=this;this.$axios.post(n.a.BLOG_DETAIL_MS,{id:this.id}).then((function(e){t.title=e.title,t.content=e.content,t.blogStatusInfo.blogStatus=e.blogStatus,t.blogStatusInfo.openStatus=e.openStatus,t.blogStatusInfo.priCode=e.priCode,t.blogStatusInfo.tagId=e.tagId,1==e.blogStatus&&(t.showDraftBtn=!1)})).catch((function(e){t.id="",t.showDraftBtn=!0,t.$message.warning(e.message)}))},imgAdd:function(t,e){var o=this,n="blogDetail/"+this.userInfo.userId+"/"+(new Date).getTime()+e.name;d.a.upImage(this,n,e,{error:function(t){o.$message.error(t)},success:function(e){o.$refs.md.$img2Url(t,"https://img.huiyong.online/"+n)},progress:function(t){}})},saveDraft:function(){this.blogStatusInfo={blogStatus:0,openStatus:"",priCode:"",tagId:""},this.addBlog()},saveBlog:function(t){this.blogStatusInfo={blogStatus:1,openStatus:t.openStatus,priCode:t.priCode,tagId:t.tagId},this.addBlog()},addBlog:function(){var t=this;this.$axios.post(this.id?n.a.BLOG_EDIT:n.a.BLOG_ADD,{id:this.id,title:this.title,content:this.content,openStatus:this.blogStatusInfo.openStatus,priCode:this.blogStatusInfo.priCode,blogStatus:this.blogStatusInfo.blogStatus,tagId:this.blogStatusInfo.tagId}).then((function(e){t.$message.success(0==t.blogStatusInfo.blogStatus?"保存草稿成功！":t.id?"修改成功！":"发布成功！"),t.showAddBlog=!1,t.$router.push("/blogDetail?userId="+t.userInfo.userId)})).catch((function(e){t.$message.warning(e.message)}))}}},f=(o(536),o(35)),component=Object(f.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"blog-edit-page"},[o("div",{staticClass:"blog-top-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"blog-title",attrs:{type:"text",placeholder:"输入标题..."},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),t._v(" "),o("div",{staticClass:"blog-top-right"},[t.showDraftBtn?o("div",{staticClass:"blog-save-btn",on:{click:function(e){return t.saveDraft()}}},[t._v("保存草稿")]):t._e(),t._v(" "),o("div",{staticClass:"blog-submit",on:{click:function(e){t.showAddBlog=!0}}},[t._v(t._s(this.id?"保存文章":"发布文章"))])])]),t._v(" "),o("add-blog",{attrs:{show:t.showAddBlog,blogStatusInfo:t.blogStatusInfo},on:{close:function(e){t.showAddBlog=!1},commit:t.saveBlog}}),t._v(" "),o("client-only",[o("div",{attrs:{id:"toolbar-container"}}),t._v(" "),o("div",{attrs:{id:"editor-container"}})])],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{AddBlog:o(493).default})}}]);